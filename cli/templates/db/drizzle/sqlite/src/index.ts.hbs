{{#if (or (eq runtime "bun") (eq runtime "node") (eq runtime "none"))}}
import { env } from "@{{projectName}}/env/server";
import * as schema from "./schema";
import { drizzle } from "drizzle-orm/libsql";
import { createClient } from "@libsql/client";

const client = createClient({
	url: env.DATABASE_URL,
{{#if (eq dbSetup "turso")}}
	authToken: env.DATABASE_AUTH_TOKEN,
{{/if}}
});

export const db = drizzle({ client, schema });
{{/if}}

{{#if (eq runtime "workers")}}
import * as schema from "./schema";

{{#if (eq dbSetup "d1")}}
import { drizzle } from "drizzle-orm/d1";
import { env } from "@{{projectName}}/env/server";

export const db = drizzle(env.DB, { schema });
{{else}}
import { drizzle } from "drizzle-orm/libsql";
import { env } from "@{{projectName}}/env/server";
import { createClient } from "@libsql/client";

const client = createClient({
	url: env.DATABASE_URL || "",
{{#if (eq dbSetup "turso")}}
	authToken: env.DATABASE_AUTH_TOKEN,
{{/if}}
});

export const db = drizzle({ client, schema });
{{/if}}
{{/if}}
